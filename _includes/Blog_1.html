<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@200..900&display=swap" rel="stylesheet">
   <style>
        p {
            font-size: 1.1em;
        } 
        body {
            font-family: "Noto Serif JP";
          
        }
    </style>

<img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg0KvzX-spRkqq4_kbsZyV9UmQHr9JYL-Dt9FnpWYPKuUG49GeODDhRpfLhbkuwdkQI4megh2UW5Hp00NZ_gGE-mRtkKaOiFwW1aeiS_KaA-1Btni1cpXcUUNHgIefXO5bnPurK8Z2AV9Rc/s800/surprise_party_woman.png" alt="surprise !" style="width: auto; height: 300px;" >

<p><span class="tti" dt="どのように～多い : Combien de gens pensent ~ ?">どのように</span> 思[おも]う人が 多[おお]い<span class="tti" dt="Question indirecte. Imaginez un point d'interrogation à la place.">のか</span>、 知[し]りたいのでご 協力[きょうりょく]おねがいします。</p>

<p>サプライズが 好[す]きです。</p>

<p>ともだちとご 飯[はん]を 食[た]べるのに、「お 店[みせ] 任[まか]せてね」と 言[い]い、ステキなお 店[みせ]に 連[つ]れて 行[い]<span class="tti" dt="～てあげる = Rendre un service à qqn">ってあげる</span>のが 好[す]きです。</p>

<p>お 誕生[たんじょう]日[び]の 子[こ]には、サプライズでバスデーケーキを 用意[ようい]して、 店内[てんない]の 明[あか]りを 落[お]として 店員[てんいん]さんに 歌[うた]を 歌[うた]ってもらう<span class="tti" dt="Ici, を est omis. Normalement, c'est '～のを憧れています'. Le の permet de nominaliser ce qui précède.">の</span> 憧[あこが]れています。
わたしもしてほしいので、お 願[ねが]いしています。</p>

<p>彼氏[かれし]からプロポーズ<span class="tti" dt="する à la forme passive.">される</span>*<span class="tti" dt="Conditionnel. 'Si ça se produit...'">なら</span>、サプライズが 絶対[ぜったい]<span class="tti" dt="よい = いい">よい</span>し、ちゃんと 動画[どうが]に 撮[と]っていて 欲[ほ]しいです。</p>

<p>観客[かんきゃく]いっぱいのなかでサプライズされたいです。</p>

<p><span class="tti" dt="'Et malgré tout'">ところが</span>、 今[いま]の 彼氏[かれし]は<span class="tti" dt="Fait allusion à tout ce dont elle a parlé AVANT.">そういう</span>*<span class="tti" dt="Ici, が est omis. Comment on sait ? Parce qu'il y a 嫌い juste après. Et on dit ～が嫌い">の</span> 嫌[きら]い<span class="tti" dt="らしい = 'A ce qu'il paraît...'/'On dirait que (mais je suis pas sûr)...'. Le く est la forme て polie.">らしく</span>、フラッシュモブの 動画[どうが]を 見[み]せ<span class="tti" dt="Verbe + ても : 'Même si/quand je lui montre... '">ても</span>*<span class="tti" dt="バカにする　= Se moquer de qqn.">バカにし</span>*<span class="tti" dt="てくる est utilisé ici pour spécifier la cible de l'action, ici le locuteur.">てきます</span>。</p>

<p>わたしの 感覚[かんかく]が 普通[ふつう]<span class="tti" dt="～(な)のか～(な)のか : 'Je sais pas si c'est A ou B'.">なのか</span>、 彼氏[かれし]が 変[か]わり者[もの]なのか、 知[し]りたいです。</p>

<p>子[こ]どものころからのあこがれなので、 彼氏[かれし]が 変[か]わり者[もの]だったら 別[わか]れたいです。</p>

<a href="https://komachi.yomiuri.co.jp/topics/id/1168277/">Source</a>

<style>
.tti {
  position: relative;
  cursor: pointer;
  
  text-decoration: underline;
  color:rgb(28, 122, 156);
}

.tti::after {
  content: attr(dt);
  position: absolute;
  background-color: #333;
  color: #fff;
  font-size: 0.8em;
  padding: 5px;
  border-radius: 5px;
  top: 100%; /* Position below the text */
  left: 50%;
 word-wrap: break-word;
  white-space: normal;
  display: none;
  z-index: 10;
  min-width: 250px;
  max-width: 500px;
}

.ttis::after {
    min-width: auto;
    max-width: none;
}

.tti:hover::after {
  display: block;
}
</style>



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/tiny-segmenter@0.2.0/dist/tiny-segmenter-0.2.0.min.js" charset="UTF-8"></script>
<script>
        document.addEventListener("DOMContentLoaded", function () {
            const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT,   {
                acceptNode: function (node) {
                return node.parentNode.nodeName != "SCRIPT" ? NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP;
                },
            },false);

            let node;
            const textNodes = [];
            while (node = walker.nextNode()) {
                textNodes.push(node);
                console.log(node.nodeValue);   
            }

            const segmenter = new TinySegmenter();   
            for(const node of textNodes)
            {
                const segs = segmenter.segment(node.nodeValue);
                console.log((segs.join(" | ")));
                const newText = segs.reduce((acc, curr, i, arr) => {
                    const prev_token = (i > 0) ? arr[i-1]:"";
                    if(curr == '[')
                    {
                        acc += `<ruby>${prev_token}<rt>`;
                    }
                    else if(prev_token == '[')
                    {
                        /* We do nothing */
                    } 
                    else if(curr == ']')
                    {
                        acc += `${prev_token}</rt></ruby>`;
                    }
                    else if(i == arr.length - 1){
                        acc += ((prev_token!=']')?prev_token:"") + curr ;
                    } 
                    else {
                        acc += ((prev_token!=']')?prev_token:"");
                    }
                    return acc;

                }, "");

                if(newText != node.nodeValue)
                {
                    let span = document.createElement('span');
                    span.innerHTML = newText;

                    node.parentNode.replaceChild(span, node);
                }
            }
        });
</script>
